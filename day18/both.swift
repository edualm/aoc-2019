import Foundation

let testInput1 = """
#########
#b.A.@.a#
#########
"""

let testInput2 = """
########################
#f.D.E.e.C.b.A.@.a.B.c.#
######################.#
#d.....................#
########################
"""

let testInput3 = """
########################
#...............b.C.D.f#
#.######################
#.....@.a.B.c.d.A.e.F.g#
########################
"""

let testInput4 = """
#################
#i.G..c...e..H.p#
########.########
#j.A..b...f..D.o#
########@########
#k.E..a...g..B.n#
########.########
#l.F..d...h..C.m#
#################
"""

let testInput5 = """
########################
#@..............ac.GI.b#
###d#e#f################
###A#B#C################
###g#h#i################
########################
"""

let testsAndResults = [(testInput1, 8), (testInput2, 86), (testInput3, 132), (testInput4, 136), (testInput5, 81)]

for (input, expectedResult) in testsAndResults {
    var bw = BoardWalker(initialState: parse(input: input))
    
    while true {
        if let r = bw.step() {
            guard expectedResult == r else {
                fatalError("Test failed!")
            }
            
            break
        }
    }
}

print("All tests passed!")

let challengeInput = """
#################################################################################
#.........#...#...........#........m#...#..............g#.............#....r#...#
#.#######.#.#C###.#######.#.#######.#.###.#########.###.#######.#.#####.#.###.#.#
#.#.....#...#.#...#..o..#.#.#.....#.#...#...#.......#...........#.#.....#.....#.#
#.#.###.#####.#.#######.#.#.#.#####.#.#.###.#.###.#############.###.###########.#
#.#...#.#...#.#...#.....#d..#.#...#.#.#.#.#.#...#.#..a#.....#...#.Y.#.....#.....#
#.###.#.#.#.#.###.#.#########.#.#.#.###.#.#.###.###.#.#.###.#####.###.###.#.###.#
#...#.#...#.#.....#...........#.#.#...#.#.#.#.#...#.#...#...#...#...#...#...#...#
###.#.#####.#######.#######.###.#P###.#.#.#.#.###.#.#####.###.#.###.###Q#####.###
#.#.#.#...#.#.....#...#.....#...#.....#.#...#...#...#...#..t..#.#.....#...#.#.#.#
#.#.#.#.###.#.#.#.###.#.#####.#########.#.###.#########.#######.#.#######.#.#.#.#
#.#...#.#...#.#.#...#.#.......#.........#.#...........#.......#...#b....#w#.....#
#.#####.#.#####.#####.###########.#####.#.###.#.#####.#####.#.#####.###.#.#######
#.....#.#.#...#.......#...#...#...#...#.#...#.#...#.#.....#.#.#...#.#.#.#.......#
###.#.#.#.#.#.###.#####.#.#.#.#.#.#.#.#####.#.###.#.#####.#.#.#.#.#.#.#.#.#####.#
#...#...#...#...#.#.....#...#.#.#.#.#...#...#...#.#.#.......#.#u#.#.#.#.#.#.....#
#.#####.#######.#.#.#########.#.###.###.#.#######.#.#.#########.#N#.#.#.###.#####
#.#.......#.....#.#.#.......#.#.....#...#.........#...#...U.#...#.#.#.#.#...#...#
#.#########.#####.#.#.#####.#.#######.#############.###.###.#.###.#.#.#E#.###.#.#
#...#.S...#.#...#...#...#.#.#.#.....#...#.........#...#f#.....#...#.#...#.....#.#
#.#.#.###.#.#.#.###.###.#.#.#.#.###.###.#.#######.###.#.###.###.###.#.#########.#
#.#...#...#...#...#.#..e#.#.#.#.#.#...#.#.......#.#...#...#.#.#...#.#.....K.....#
#.#####.#.#####.#.#######.#.#.#.#.###.#.#.#####.#.#.#####.###J###.#.#############
#...#...#.#...#.#...#...#...#...#.....#.#...#...#.#.....#.#...#n..#.#.....#.....#
###.#.#####.#.#####.#.#.#.#######.#####.###.#.#####.#####.#.###.###.#.###.###.###
#...#...#...#.......#.#...#.....#.#...#.#...#.#...#.#.....#.#.#.#...#.#.....#...#
#.#####L#.###########.#######.###.#.#.#.#.###.#.#.#.#.###.#.#.#.###.#.#####.###.#
#...#...#.............#.......#...#.#...#.#.#...#...#.F.#.#.#.#...B.#...#.......#
###.#.#.###############.###.#.#.###.###.#.#.###########.###.#.#######.#.#########
#.#.#.#.#.......X.....#.#...#.#.....#...#...#...#.....#...#.#.......#.#.#z......#
#.#.#.###.#######.###.#.#.###.#######.#####.#.#.###.#.###.#.#.#####.###.#.#####.#
#.#.#.....#...#.#...#.#.#...#...#...#...#.#...#.....#...#j..#.#...#...#.#.#.....#
#.#.#######.#.#.###.#.#####.#####.#.###.#.#############.#####.#.#.###.#.#.#.#####
#.#.#.......#...#...#.......#.....#...#.#.....#.....#...#...#.#.#...#.#.#.#.....#
#.#.#######.###.#.###.#####.#.#######.#.#.#####.###.#.###.#.#.#.#####.#.#.#####.#
#...#.....#...#.#.#...#...#.#...#...#...#.....#.#...#.#...#...#.......#.......#.#
#.###.###.#.#.#.#.#####.#.#####.#.#.#####.###.#.#.#.#.###.#####.#########.#####.#
#.#...#.#.#.#.#.#.#.....#.....#h..#.#...#.#.#.#.#.#.#.....#...#l#.......#.#.....#
#.#.###.#.###.#.#.#.#########.#####.###.#.#.#.#.#.#########.###.#.#####.###.###.#
#...#.........#.#...........#...............#...#.................#.........#...#
#######################################.@.#######################################
#.........#.......#.....#...........#.........#.............H...#...#.#...#.....#
#.#.#######.###.#.#.#.###.#######.#.#.#.#.#.###.#####.#########.#.#.#.#.#.#.#.#.#
#.#...#.......#.#...#.#...#.....#.#.#.#.#.#.#...#...#...#.....#..x#.#...#...#.#.#
#.###.#.#######.#####.#.###.###.#.#.#.#.#.###.###.#.###.#.###.#####.#####.###.#.#
#.#.#...#.......#.....#.#.#.#.....#.#.#.#.....#...#.#...#...#.....#.....#.#...#.#
#.#.#####.#######.#####.#.#.#######.#.#.#.#######.###.#####.#####.#####.###.#####
#.Z...#.#...#.....#.#.....#.#.....#.#.#.#.#.......#...#.#...#.....#...#...#.#...#
#####.#.###.###.###.#.#####.#.###.#.#.#.#.#.###.###.###.#.###.#####.#.###.#.#.#.#
#...#v#...#...#.....#.#.....#.#.#.#...#.#.#...#.#...#...#...#.....#.#.....#...#.#
#.#.#.#.#.###.#####.#.#.#####.#.#.#####.#.###.###.###.#.###.#####.#.###########.#
#.#...#.#.I.#...#...#.#.....#...#...#...#...#.#...#...#.#...#...#.#...#.......#.#
#.#########.###.#####.#####.###.###.#######.#.#.###.###.#.#####.#.###.#.#.###.#.#
#.#...#.......#...........#...#.#.#.....#.....#.#.....#.#.......#...#.#.#.#.#...#
#.#.#.#.#####.###############.#.#.#####.#.#####.#.###.#.#######.#.#.#.###.#.###.#
#...#...#...#.#...#...#.......#.......#.#.#.....#.#.#.#.#...#...#.#.#...#.#...#.#
#########.#.#.###.#.#.#.###########.###.###.#####.#.#.###.#.#.###.#####.#.#.#.#.#
#...#...#.#.#.....#.#...#...#.......#...#...#...#...#.....#.....#.....#.#.#.#...#
#.###.#.#.#.#####.#.#####.#.#.#######.#.#.###.#.###########.#######.###.#.#####.#
#...#.#...#.....#.#.......#...#.#.....#.#.....#..........s#...#.....#...#.....#.#
###.#.#######.###.###########.#.#.#######################.#.###.#####.#######.#.#
#...#.#...#.#.....#.#.......#.#.#...#...#.....#.........#.#.#.#...#...#.......#.#
#.###.#.#.#.#######.#######.#.#.###.#.#.#.###.#########.#.#.#.#.#.#.###.#######.#
#...#...#...#.......#.....#.#.....#...#.#.#.............#.#.#.#.#.....#.#.....#.#
#.#.#######.###.###.#.###.#.#.#######.#.#.#############.#.###.#######.#.#####.#.#
#.#...#...#.....#...#.#...#.#.#.....#.#.#...#.......#...#.#...#.....#.#.#...#...#
#####.#.#.#######.#####.#.#.###.###.#.#.#.#.#.###.###.###.#.###.###.#.#.#.#.#####
#.....#.#...#...#...D...#.#...#.#.#.#.#.#.#.#...#.....#...#.....#...#.#...#.#...#
#R#####.###.#.#.#########.###.#.#.#.#.#.###.###.#######.#########.###.#####.#.#.#
#.#...#...#y..#.#.....#.#.#.#...#...#.#.#...#.#.....#.#.....#.....#.#.....#...#.#
#.#.#.###.#####.#.#.#.#.#.#.#####.#####.#.###.#####.#.###.###.#####.#####.#####.#
#...#.....#...#...#.#...#.#.....#.....#.#.#.............#.....#...#.....#.......#
#.#########W#.#####.###T#.#.###.#####.#.#.#####################.###.#.#.#######.#
#.....#.....#k....#.#...#...#.#.#.#...#.#...........#.............#.#.#.....#...#
#####.#.#########.#.#########.#.#.#.###.#.#########.#.###########O#.#.#.#####.###
#.....#.......#.#.#.#.......#...#.#.#...#...#.#.....#.#.....M.#...#.#.#.#.....#.#
#.#####.#####.#.#.#.#.###.#.#.###.#.###.###.#.#.###.#.#######.#.###.#.#.#.#####.#
#...#...#.....#.#.#.#...#.#.#...#.#...#p#c#.#.#...#.#...#.....#...#.#.#.#...V...#
###.#####.#####.#.#.###.#.#####.#G###.#.#.#.#.###.#####.#.###.###.#.#.#########.#
#....q....#.......#...A.#...........#...#.......#.........#.....#...#......i....#
#################################################################################
"""

var bw = BoardWalker(initialState: parse(input: challengeInput))

while true {
    if let r = bw.step() {
        print("Part 1 result: \(r)")
        
        break
    }
}

let fullChallengeInput = """
#################################################################################
#.........#...#...........#........m#...#..............g#.............#....r#...#
#.#######.#.#C###.#######.#.#######.#.###.#########.###.#######.#.#####.#.###.#.#
#.#.....#...#.#...#..o..#.#.#.....#.#...#...#.......#...........#.#.....#.....#.#
#.#.###.#####.#.#######.#.#.#.#####.#.#.###.#.###.#############.###.###########.#
#.#...#.#...#.#...#.....#d..#.#...#.#.#.#.#.#...#.#..a#.....#...#.Y.#.....#.....#
#.###.#.#.#.#.###.#.#########.#.#.#.###.#.#.###.###.#.#.###.#####.###.###.#.###.#
#...#.#...#.#.....#...........#.#.#...#.#.#.#.#...#.#...#...#...#...#...#...#...#
###.#.#####.#######.#######.###.#P###.#.#.#.#.###.#.#####.###.#.###.###Q#####.###
#.#.#.#...#.#.....#...#.....#...#.....#.#...#...#...#...#..t..#.#.....#...#.#.#.#
#.#.#.#.###.#.#.#.###.#.#####.#########.#.###.#########.#######.#.#######.#.#.#.#
#.#...#.#...#.#.#...#.#.......#.........#.#...........#.......#...#b....#w#.....#
#.#####.#.#####.#####.###########.#####.#.###.#.#####.#####.#.#####.###.#.#######
#.....#.#.#...#.......#...#...#...#...#.#...#.#...#.#.....#.#.#...#.#.#.#.......#
###.#.#.#.#.#.###.#####.#.#.#.#.#.#.#.#####.#.###.#.#####.#.#.#.#.#.#.#.#.#####.#
#...#...#...#...#.#.....#...#.#.#.#.#...#...#...#.#.#.......#.#u#.#.#.#.#.#.....#
#.#####.#######.#.#.#########.#.###.###.#.#######.#.#.#########.#N#.#.#.###.#####
#.#.......#.....#.#.#.......#.#.....#...#.........#...#...U.#...#.#.#.#.#...#...#
#.#########.#####.#.#.#####.#.#######.#############.###.###.#.###.#.#.#E#.###.#.#
#...#.S...#.#...#...#...#.#.#.#.....#...#.........#...#f#.....#...#.#...#.....#.#
#.#.#.###.#.#.#.###.###.#.#.#.#.###.###.#.#######.###.#.###.###.###.#.#########.#
#.#...#...#...#...#.#..e#.#.#.#.#.#...#.#.......#.#...#...#.#.#...#.#.....K.....#
#.#####.#.#####.#.#######.#.#.#.#.###.#.#.#####.#.#.#####.###J###.#.#############
#...#...#.#...#.#...#...#...#...#.....#.#...#...#.#.....#.#...#n..#.#.....#.....#
###.#.#####.#.#####.#.#.#.#######.#####.###.#.#####.#####.#.###.###.#.###.###.###
#...#...#...#.......#.#...#.....#.#...#.#...#.#...#.#.....#.#.#.#...#.#.....#...#
#.#####L#.###########.#######.###.#.#.#.#.###.#.#.#.#.###.#.#.#.###.#.#####.###.#
#...#...#.............#.......#...#.#...#.#.#...#...#.F.#.#.#.#...B.#...#.......#
###.#.#.###############.###.#.#.###.###.#.#.###########.###.#.#######.#.#########
#.#.#.#.#.......X.....#.#...#.#.....#...#...#...#.....#...#.#.......#.#.#z......#
#.#.#.###.#######.###.#.#.###.#######.#####.#.#.###.#.###.#.#.#####.###.#.#####.#
#.#.#.....#...#.#...#.#.#...#...#...#...#.#...#.....#...#j..#.#...#...#.#.#.....#
#.#.#######.#.#.###.#.#####.#####.#.###.#.#############.#####.#.#.###.#.#.#.#####
#.#.#.......#...#...#.......#.....#...#.#.....#.....#...#...#.#.#...#.#.#.#.....#
#.#.#######.###.#.###.#####.#.#######.#.#.#####.###.#.###.#.#.#.#####.#.#.#####.#
#...#.....#...#.#.#...#...#.#...#...#...#.....#.#...#.#...#...#.......#.......#.#
#.###.###.#.#.#.#.#####.#.#####.#.#.#####.###.#.#.#.#.###.#####.#########.#####.#
#.#...#.#.#.#.#.#.#.....#.....#h..#.#...#.#.#.#.#.#.#.....#...#l#.......#.#.....#
#.#.###.#.###.#.#.#.#########.#####.###.#.#.#.#.#.#########.###.#.#####.###.###.#
#...#.........#.#...........#..........@#@..#...#.................#.........#...#
#################################################################################
#.........#.......#.....#...........#..@#@....#.............H...#...#.#...#.....#
#.#.#######.###.#.#.#.###.#######.#.#.#.#.#.###.#####.#########.#.#.#.#.#.#.#.#.#
#.#...#.......#.#...#.#...#.....#.#.#.#.#.#.#...#...#...#.....#..x#.#...#...#.#.#
#.###.#.#######.#####.#.###.###.#.#.#.#.#.###.###.#.###.#.###.#####.#####.###.#.#
#.#.#...#.......#.....#.#.#.#.....#.#.#.#.....#...#.#...#...#.....#.....#.#...#.#
#.#.#####.#######.#####.#.#.#######.#.#.#.#######.###.#####.#####.#####.###.#####
#.Z...#.#...#.....#.#.....#.#.....#.#.#.#.#.......#...#.#...#.....#...#...#.#...#
#####.#.###.###.###.#.#####.#.###.#.#.#.#.#.###.###.###.#.###.#####.#.###.#.#.#.#
#...#v#...#...#.....#.#.....#.#.#.#...#.#.#...#.#...#...#...#.....#.#.....#...#.#
#.#.#.#.#.###.#####.#.#.#####.#.#.#####.#.###.###.###.#.###.#####.#.###########.#
#.#...#.#.I.#...#...#.#.....#...#...#...#...#.#...#...#.#...#...#.#...#.......#.#
#.#########.###.#####.#####.###.###.#######.#.#.###.###.#.#####.#.###.#.#.###.#.#
#.#...#.......#...........#...#.#.#.....#.....#.#.....#.#.......#...#.#.#.#.#...#
#.#.#.#.#####.###############.#.#.#####.#.#####.#.###.#.#######.#.#.#.###.#.###.#
#...#...#...#.#...#...#.......#.......#.#.#.....#.#.#.#.#...#...#.#.#...#.#...#.#
#########.#.#.###.#.#.#.###########.###.###.#####.#.#.###.#.#.###.#####.#.#.#.#.#
#...#...#.#.#.....#.#...#...#.......#...#...#...#...#.....#.....#.....#.#.#.#...#
#.###.#.#.#.#####.#.#####.#.#.#######.#.#.###.#.###########.#######.###.#.#####.#
#...#.#...#.....#.#.......#...#.#.....#.#.....#..........s#...#.....#...#.....#.#
###.#.#######.###.###########.#.#.#######################.#.###.#####.#######.#.#
#...#.#...#.#.....#.#.......#.#.#...#...#.....#.........#.#.#.#...#...#.......#.#
#.###.#.#.#.#######.#######.#.#.###.#.#.#.###.#########.#.#.#.#.#.#.###.#######.#
#...#...#...#.......#.....#.#.....#...#.#.#.............#.#.#.#.#.....#.#.....#.#
#.#.#######.###.###.#.###.#.#.#######.#.#.#############.#.###.#######.#.#####.#.#
#.#...#...#.....#...#.#...#.#.#.....#.#.#...#.......#...#.#...#.....#.#.#...#...#
#####.#.#.#######.#####.#.#.###.###.#.#.#.#.#.###.###.###.#.###.###.#.#.#.#.#####
#.....#.#...#...#...D...#.#...#.#.#.#.#.#.#.#...#.....#...#.....#...#.#...#.#...#
#R#####.###.#.#.#########.###.#.#.#.#.#.###.###.#######.#########.###.#####.#.#.#
#.#...#...#y..#.#.....#.#.#.#...#...#.#.#...#.#.....#.#.....#.....#.#.....#...#.#
#.#.#.###.#####.#.#.#.#.#.#.#####.#####.#.###.#####.#.###.###.#####.#####.#####.#
#...#.....#...#...#.#...#.#.....#.....#.#.#.............#.....#...#.....#.......#
#.#########W#.#####.###T#.#.###.#####.#.#.#####################.###.#.#.#######.#
#.....#.....#k....#.#...#...#.#.#.#...#.#...........#.............#.#.#.....#...#
#####.#.#########.#.#########.#.#.#.###.#.#########.#.###########O#.#.#.#####.###
#.....#.......#.#.#.#.......#...#.#.#...#...#.#.....#.#.....M.#...#.#.#.#.....#.#
#.#####.#####.#.#.#.#.###.#.#.###.#.###.###.#.#.###.#.#######.#.###.#.#.#.#####.#
#...#...#.....#.#.#.#...#.#.#...#.#...#p#c#.#.#...#.#...#.....#...#.#.#.#...V...#
###.#####.#####.#.#.###.#.#####.#G###.#.#.#.#.###.#####.#.###.###.#.#.#########.#
#....q....#.......#...A.#...........#...#.......#.........#.....#...#......i....#
#################################################################################
"""

let challengeInput1 = """
#########################################
#.........#...#...........#........m#...#
#.#######.#.#C###.#######.#.#######.#.###
#.#.....#...#.#...#..o..#.#.#.....#.#...#
#.#.###.#####.#.#######.#.#.#.#####.#.#.#
#.#...#.#...#.#...#.....#d..#.#...#.#.#.#
#.###.#.#.#.#.###.#.#########.#.#.#.###.#
#...#.#...#.#.....#...........#.#.#...#.#
###.#.#####.#######.#######.###.#P###.#.#
#.#.#.#...#.#.....#...#.....#...#.....#.#
#.#.#.#.###.#.#.#.###.#.#####.#########.#
#.#...#.#...#.#.#...#.#.......#.........#
#.#####.#.#####.#####.###########.#####.#
#.....#.#.#...#.......#...#...#...#...#.#
###.#.#.#.#.#.###.#####.#.#.#.#.#.#.#.###
#...#...#...#...#.#.....#...#.#.#.#.#...#
#.#####.#######.#.#.#########.#.###.###.#
#.#.......#.....#.#.#.......#.#.....#...#
#.#########.#####.#.#.#####.#.#######.###
#...#.S...#.#...#...#...#.#.#.#.....#...#
#.#.#.###.#.#.#.###.###.#.#.#.#.###.###.#
#.#...#...#...#...#.#..e#.#.#.#.#.#...#.#
#.#####.#.#####.#.#######.#.#.#.#.###.#.#
#...#...#.#...#.#...#...#...#...#.....#.#
###.#.#####.#.#####.#.#.#.#######.#####.#
#...#...#...#.......#.#...#.....#.#...#.#
#.#####L#.###########.#######.###.#.#.#.#
#...#...#.............#.......#...#.#...#
###.#.#.###############.###.#.#.###.###.#
#.#.#.#.#.......X.....#.#...#.#.....#...#
#.#.#.###.#######.###.#.#.###.#######.###
#.#.#.....#...#.#...#.#.#...#...#...#...#
#.#.#######.#.#.###.#.#####.#####.#.###.#
#.#.#.......#...#...#.......#.....#...#.#
#.#.#######.###.#.###.#####.#.#######.#.#
#...#.....#...#.#.#...#...#.#...#...#...#
#.###.###.#.#.#.#.#####.#.#####.#.#.#####
#.#...#.#.#.#.#.#.#.....#.....#h..#.#...#
#.#.###.#.###.#.#.#.#########.#####.###.#
#...#.........#.#...........#..........@#
#########################################
"""

let challengeInput2 = """
#########################################
#..............g#.............#....r#...#
#.#########.###.#######.#.#####.#.###.#.#
#...#.......#...........#.#.....#.....#.#
###.#.###.#############.###.###########.#
#.#.#...#.#..a#.....#...#.Y.#.....#.....#
#.#.###.###.#.#.###.#####.###.###.#.###.#
#.#.#.#...#.#...#...#...#...#...#...#...#
#.#.#.###.#.#####.###.#.###.###Q#####.###
#...#...#...#...#..t..#.#.....#...#.#.#.#
#.###.#########.#######.#.#######.#.#.#.#
#.#...........#.......#...#b....#w#.....#
#.###.#.#####.#####.#.#####.###.#.#######
#...#.#...#.#.....#.#.#...#.#.#.#.......#
###.#.###.#.#####.#.#.#.#.#.#.#.#.#####.#
#...#...#.#.#.......#.#u#.#.#.#.#.#.....#
#.#######.#.#.#########.#N#.#.#.###.#####
#.........#...#...U.#...#.#.#.#.#...#...#
###########.###.###.#.###.#.#.#E#.###.#.#
#.........#...#f#.....#...#.#...#.....#.#
#.#######.###.#.###.###.###.#.#########.#
#.......#.#...#...#.#.#...#.#.....K.....#
#.#####.#.#.#####.###J###.#.#############
#...#...#.#.....#.#...#n..#.#.....#.....#
###.#.#####.#####.#.###.###.#.###.###.###
#...#.#...#.#.....#.#.#.#...#.#.....#...#
#.###.#.#.#.#.###.#.#.#.###.#.#####.###.#
#.#.#...#...#.F.#.#.#.#...B.#...#.......#
#.#.###########.###.#.#######.#.#########
#...#...#.....#...#.#.......#.#.#z......#
###.#.#.###.#.###.#.#.#####.###.#.#####.#
#.#...#.....#...#j..#.#...#...#.#.#.....#
#.#############.#####.#.#.###.#.#.#.#####
#.....#.....#...#...#.#.#...#.#.#.#.....#
#.#####.###.#.###.#.#.#.#####.#.#.#####.#
#.....#.#...#.#...#...#.......#.......#.#
#.###.#.#.#.#.###.#####.#########.#####.#
#.#.#.#.#.#.#.....#...#l#.......#.#.....#
#.#.#.#.#.#########.###.#.#####.###.###.#
#@..#...#.................#.........#...#
#########################################
"""

let challengeInput3 = """
#########################################
#.........#.......#.....#...........#..@#
#.#.#######.###.#.#.#.###.#######.#.#.#.#
#.#...#.......#.#...#.#...#.....#.#.#.#.#
#.###.#.#######.#####.#.###.###.#.#.#.#.#
#.#.#...#.......#.....#.#.#.#.....#.#.#.#
#.#.#####.#######.#####.#.#.#######.#.#.#
#.Z...#.#...#.....#.#.....#.#.....#.#.#.#
#####.#.###.###.###.#.#####.#.###.#.#.#.#
#...#v#...#...#.....#.#.....#.#.#.#...#.#
#.#.#.#.#.###.#####.#.#.#####.#.#.#####.#
#.#...#.#.I.#...#...#.#.....#...#...#...#
#.#########.###.#####.#####.###.###.#####
#.#...#.......#...........#...#.#.#.....#
#.#.#.#.#####.###############.#.#.#####.#
#...#...#...#.#...#...#.......#.......#.#
#########.#.#.###.#.#.#.###########.###.#
#...#...#.#.#.....#.#...#...#.......#...#
#.###.#.#.#.#####.#.#####.#.#.#######.#.#
#...#.#...#.....#.#.......#...#.#.....#.#
###.#.#######.###.###########.#.#.#######
#...#.#...#.#.....#.#.......#.#.#...#...#
#.###.#.#.#.#######.#######.#.#.###.#.#.#
#...#...#...#.......#.....#.#.....#...#.#
#.#.#######.###.###.#.###.#.#.#######.#.#
#.#...#...#.....#...#.#...#.#.#.....#.#.#
#####.#.#.#######.#####.#.#.###.###.#.#.#
#.....#.#...#...#...D...#.#...#.#.#.#.#.#
#R#####.###.#.#.#########.###.#.#.#.#.#.#
#.#...#...#y..#.#.....#.#.#.#...#...#.#.#
#.#.#.###.#####.#.#.#.#.#.#.#####.#####.#
#...#.....#...#...#.#...#.#.....#.....#.#
#.#########W#.#####.###T#.#.###.#####.#.#
#.....#.....#k....#.#...#...#.#.#.#...#.#
#####.#.#########.#.#########.#.#.#.###.#
#.....#.......#.#.#.#.......#...#.#.#...#
#.#####.#####.#.#.#.#.###.#.#.###.#.###.#
#...#...#.....#.#.#.#...#.#.#...#.#...#p#
###.#####.#####.#.#.###.#.#####.#G###.#.#
#....q....#.......#...A.#...........#...#
#########################################
"""

let challengeInput4 = """
#########################################
#@....#.............H...#...#.#...#.....#
#.#.###.#####.#########.#.#.#.#.#.#.#.#.#
#.#.#...#...#...#.....#..x#.#...#...#.#.#
#.###.###.#.###.#.###.#####.#####.###.#.#
#.....#...#.#...#...#.....#.....#.#...#.#
#.#######.###.#####.#####.#####.###.#####
#.#.......#...#.#...#.....#...#...#.#...#
#.#.###.###.###.#.###.#####.#.###.#.#.#.#
#.#...#.#...#...#...#.....#.#.....#...#.#
#.###.###.###.#.###.#####.#.###########.#
#...#.#...#...#.#...#...#.#...#.......#.#
###.#.#.###.###.#.#####.#.###.#.#.###.#.#
#.....#.#.....#.#.......#...#.#.#.#.#...#
#.#####.#.###.#.#######.#.#.#.###.#.###.#
#.#.....#.#.#.#.#...#...#.#.#...#.#...#.#
###.#####.#.#.###.#.#.###.#####.#.#.#.#.#
#...#...#...#.....#.....#.....#.#.#.#...#
#.###.#.###########.#######.###.#.#####.#
#.....#..........s#...#.....#...#.....#.#
#################.#.###.#####.#######.#.#
#.....#.........#.#.#.#...#...#.......#.#
#.###.#########.#.#.#.#.#.#.###.#######.#
#.#.............#.#.#.#.#.....#.#.....#.#
#.#############.#.###.#######.#.#####.#.#
#...#.......#...#.#...#.....#.#.#...#...#
#.#.#.###.###.###.#.###.###.#.#.#.#.#####
#.#.#...#.....#...#.....#...#.#...#.#...#
###.###.#######.#########.###.#####.#.#.#
#...#.#.....#.#.....#.....#.#.....#...#.#
#.###.#####.#.###.###.#####.#####.#####.#
#.#.............#.....#...#.....#.......#
#.#####################.###.#.#.#######.#
#...........#.............#.#.#.....#...#
#.#########.#.###########O#.#.#.#####.###
#...#.#.....#.#.....M.#...#.#.#.#.....#.#
###.#.#.###.#.#######.#.###.#.#.#.#####.#
#c#.#.#...#.#...#.....#...#.#.#.#...V...#
#.#.#.###.#####.#.###.###.#.#.#########.#
#.......#.........#.....#...#......i....#
#########################################
"""

var sum = 0

for i in [challengeInput1, challengeInput2, challengeInput3, challengeInput4] {
    var bw = BoardWalker(initialState: parse(input: i))
    
    while true {
        if let r = bw.step() {
            sum += r
            
            break
        }
    }
}

print("Part 2 result: \(sum)")
